#:import ShadowBox widgets.containers.ShadowBox
#:import Text widgets.inputs.Text
#:import IconButton widgets.buttons.IconButton
#:import OverlayContainer widgets.containers.OverlayContainer
#:import BoxStatus widgets.containers.BoxStatus

# Home Monitoring Section
<StressMonitorLayout>:
    padding: dp(16)
    spacing: dp(16)
    canvas.before:
        Color:
            rgba: app.colors.grey_light
        Rectangle:
            pos: self.pos
            size: self.size

    ## Container for Camera and Graph
    BoxLayout:
        padding: dp(6)
        orientation: 'vertical'
        Text:
            size_hint_y: 0.1
            text: "v0.1"

        BoxLayout:
            spacing: dp(10)
            
            ## Camera Section 
            AnchorLayout:
                anchor_y: 'top'
                size_hint_x: 0.4
                ShadowBox:
                    radius: [dp(8)] ## Rounded 16dp
                    elevation: 2
                    size_hint: 1, 0.7
                    padding: dp(16)
                    spacing: dp(8)
                    orientation: "vertical" 
                    BoxLayout:
                        size_hint_y: .1
                        orientation: 'horizontal'
                        AnchorLayout:
                            anchor_x: 'left'
                            anchor_y: 'center'
                            Text:
                                text: "Camera Feed"
                                font_name: app.fonts.body
                                font_size: app.fonts.size.h3
                                color: app.colors.black
                        AnchorLayout:
                            anchor_x: 'right'
                            anchor_y: 'center'
                            IconButton:
                                size_hint: None, None
                                size: dp(16), dp(16)
                                source: 'assets/icons/camera-solid.png'
                    
                    BoxLayout: 
                        size_hint_y: 0.5
                        CameraLayout:

                    BoxLayout:
                        size_hint_y: .1
                        orientation: 'horizontal'
                        AnchorLayout:
                            anchor_x: 'left'
                            anchor_y: 'center'
                            Text:
                                text: "Status Camera: On"
                                font_name: app.fonts.body
                                font_size: app.fonts.size.h5
                                color: app.colors.primary
                        AnchorLayout:
                            anchor_x: 'right'
                            anchor_y: 'center'
                            IconButton:
                                size_hint: None, None
                                size: dp(16), dp(16)
                                source: 'assets/icons/circle-solid.png'
                    
                    
            ## Physiology Section
            AnchorLayout:
                anchor_y: 'top'
                size_hint_x: 0.6
                ShadowBox:
                    radius: [dp(16)] ## Rounded 16dp
                    elevation: 2
                    size_hint: 1, 0.7
                    padding: dp(16)
                    spacing: dp(8)
                    orientation: "vertical" 

                    BoxLayout:
                        size_hint_y: 0.1
                        orientation: 'horizontal'

                        AnchorLayout:
                            anchor_x: 'left'
                            anchor_y: 'center'
                            Text:
                                text: "Heart Rate"
                                font_name: app.fonts.body
                                font_size: app.fonts.size.h3
                                color: app.colors.grey_dark
                        AnchorLayout:
                            anchor_x: 'right'
                            anchor_y: 'center'
                            padding: dp(4)
                                            
                            BoxLayout:
                                size_hint_x: None  
                                spacing: dp(12)  ## Ensures space between Text and Icon
                                padding: dp(4)  

                                BoxLayout:
                                    spacing: dp(4)  
                                    Text:
                                        text: "75"
                                        font_name: app.fonts.body
                                        font_size: app.fonts.size.h2
                                        color: app.colors.danger
                                        width: self.texture_size[0]
                                    Text:
                                        text: "BPM"
                                        font_name: app.fonts.body
                                        font_size: app.fonts.size.h4
                                        color: app.colors.black
                                        width: self.texture_size[0] 

                    BoxLayout:
                        size_hint_y: 0.6
                        OverlayContainer:

                    ## Physiology Status StatusIndicator
                    BoxLayout:
                        size_hint: 1, 0.3
                        elevation: 2
                        padding: dp(8)
                        spacing: dp(8)
                        canvas.before:
                            Color:
                                rgba: app.colors.grey_dark
                            RoundedRectangle:
                                size: self.size
                                pos: self.pos
                                radius: [1]



<CameraLayout>:
    allow_stretch: True
    size_hint: 1,1
    keep_ratio: True
    canvas.before:
        StencilPush
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [10]  # Adjust for roundness
        StencilUse

    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            texture: self.texture  # Keeps the camera feed
            pos: self.pos
            size: self.size

    canvas.after:
        StencilUnUse
        StencilPop
    

<HeartRateLayout>:
    orientation: 'vertical'
    Label:
        id: hr_label
        text: "Heart Rate: 75 BPM"
        font_size: '20sp'
